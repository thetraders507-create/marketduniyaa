<!DOCTYPE html>
<html>
<head>
    <title>MarketDuniyaa | Live Market & Business Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background-color: #0f172a;
            color: white;
        }
        header {
            background: #111827;
            padding: 20px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            letter-spacing: 1px;
            border-bottom: 1px solid #1f2937;
        }
        header nav a {
            margin: 0 10px;
            text-decoration: none;
            font-size: 16px;
        }
        .container {
            padding: 20px;
            max-width: 1100px;
            margin: auto;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .card {
            background: #1e293b;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
        }
        .card h3 { font-size: 18px; color: #94a3b8; }
        .price { font-size: 24px; margin: 10px 0; }
        .signal-box {
            text-align: center;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            font-size: 22px;
            font-weight: bold;
        }
        .buy { background: #064e3b; color: #10b981; }
        .sell { background: #4c0519; color: #f43f5e; }
        .neutral { background: #1e293b; color: #facc15; }
        input, textarea { border-radius: 6px; border: none; outline: none; }
        button:hover { opacity: 0.9; cursor: pointer; }
        footer {
            margin-top: 40px;
            padding: 20px;
            text-align: center;
            font-size: 12px;
            color: #9ca3af;
            border-top: 1px solid #1f2937;
        }
    </style>
</head>

<body>

<header>
    ðŸ“Š MarketDuniyaa Live Market & Business Dashboard
    <nav>
        <a href="#signals" style="color:#10b981;">Signals</a>
        <a href="#portfolio" style="color:#94a3b8;">Portfolio</a>
        <a href="#analytics" style="color:#94a3b8;">Analytics</a>
        <a href="#contact" style="color:#94a3b8;">Contact</a>
    </nav>
</header>

<!-- Market Signals -->
<div class="container" id="signals">

    <div id="signalBox" class="signal-box neutral">
        Calculating Signal...
    </div>

    <div class="grid">
        <div class="card">
            <h3>NIFTY 50</h3>
            <div id="niftyPrice" class="price">Loading...</div>
        </div>

        <div class="card">
            <h3>BANK NIFTY</h3>
            <div id="bankNiftyPrice" class="price">Loading...</div>
        </div>

        <div class="card">
            <h3>Gold</h3>
            <div id="goldPrice" class="price">â‚¹ 62,000 (Demo)</div>
        </div>

        <div class="card">
            <h3>Bitcoin</h3>
            <div id="btcPrice" class="price">Loading...</div>
        </div>
    </div>
</div>

<!-- Portfolio Section -->
<div class="container" id="portfolio">
    <h2>ðŸ’¼ Business / Portfolio Overview</h2>
    <div class="grid">
        <div class="card"><h3>Total Revenue</h3><div class="price">â‚¹ 1,25,000</div></div>
        <div class="card"><h3>Total Expenses</h3><div class="price">â‚¹ 65,000</div></div>
        <div class="card"><h3>Net Profit</h3><div class="price">â‚¹ 60,000</div></div>
    </div>
</div>

<!-- Live Market Chart -->
<div class="container" id="analytics">
    <h2>ðŸ“ˆ Live NIFTY & BANK NIFTY Chart</h2>
    <canvas id="marketChart" height="200"></canvas>
</div>

<!-- Business Analytics Chart -->
<div class="container">
    <h2>ðŸ“Š Business Analytics (Revenue vs Expenses)</h2>
    <canvas id="businessChart" height="150"></canvas>
</div>

<!-- Contact Form -->
<div class="container" id="contact">
    <h2>ðŸ“¬ Contact Us</h2>
    <div class="card">
        <form id="contactForm">
            <label>Name:</label><br>
            <input type="text" name="name" required style="width:100%;padding:8px;margin:5px 0;"><br>
            <label>Email:</label><br>
            <input type="email" name="email" required style="width:100%;padding:8px;margin:5px 0;"><br>
            <label>Message:</label><br>
            <textarea name="message" required style="width:100%;padding:8px;margin:5px 0;"></textarea><br>
            <button type="submit" style="background:#10b981;color:#111827;padding:10px 15px;border:none;border-radius:6px;">Send</button>
        </form>
    </div>
</div>

<footer>
    âš  This platform is for educational purposes only. We are not SEBI registered advisors.
</footer>

<script>
    // EMA Calculation
    function calculateEMA(prices, period) {
        let k = 2 / (period + 1);
        let ema = prices[0];
        for (let i = 1; i < prices.length; i++) {
            ema = prices[i] * k + ema * (1 - k);
        }
        return ema;
    }

    // Signal demo prices
    let demoPrices = [22000,22100,22200,22300,22400,22500,22600,22700,22800,22900];
    let ema9 = calculateEMA(demoPrices, 9);
    let ema15 = calculateEMA(demoPrices, 15);
    let lastPrice = demoPrices[demoPrices.length - 1];
    const signalBox = document.getElementById("signalBox");
    if (lastPrice > ema9 && ema9 > ema15) {
        signalBox.innerHTML = "ðŸš€ BUY SIGNAL";
        signalBox.className = "signal-box buy";
    } else if (lastPrice < ema9 && ema9 < ema15) {
        signalBox.innerHTML = "ðŸ”» SELL SIGNAL";
        signalBox.className = "signal-box sell";
    } else {
        signalBox.innerHTML = "âš  NO CLEAR SIGNAL";
        signalBox.className = "signal-box neutral";
    }

    // Live Market Updates
    const niftyPriceEl = document.getElementById("niftyPrice");
    const bankNiftyPriceEl = document.getElementById("bankNiftyPrice");
    const btcPriceEl = document.getElementById("btcPrice");

    // Market Chart
    const ctxMarket = document.getElementById('marketChart').getContext('2d');
    let marketChart = new Chart(ctxMarket, {
        type: 'line',
        data: {
            labels: [],
            datasets: [
                { label:'NIFTY 50', data:[], borderColor:'#10b981', fill:false, tension:0.3 },
                { label:'BANK NIFTY', data:[], borderColor:'#f43f5e', fill:false, tension:0.3 }
            ]
        },
        options: {
            responsive:true,
            plugins:{ legend:{ labels:{color:'white'}}},
            scales:{
                x:{ ticks:{color:'white'}, grid:{color:'#1f2937'} },
                y:{ ticks:{color:'white'}, grid:{color:'#1f2937'} }
            }
        }
    });

    function updateMarket() {
        const now = new Date();
        const timeLabel = now.getHours() + ':' + now.getMinutes() + ':' + now.getSeconds();

        Promise.all([
            fetch('https://military-jobye-haiqstudios-14f59639.koyeb.app/stock?symbol=NIFTY50').then(res => res.json()),
            fetch('https://military-jobye-haiqstudios-14f59639.koyeb.app/stock?symbol=NIFTYBANK').then(res => res.json())
        ])
        .then(([niftyData, bankNiftyData])=>{
            const niftyPrice = niftyData.data.last_price;
            const bankNiftyPrice = bankNiftyData.data.last_price;

            niftyPriceEl.innerHTML = "â‚¹ " + niftyPrice;
            bankNiftyPriceEl.innerHTML = "â‚¹ " + bankNiftyPrice;

            marketChart.data.labels.push(timeLabel);
            marketChart.data.datasets[0].data.push(niftyPrice);
            marketChart.data.datasets[1].data.push(bankNiftyPrice);

            if(marketChart.data.labels.length>20){
                marketChart.data.labels.shift();
                marketChart.data.datasets[0].data.shift();
                marketChart.data.datasets[1].data.shift();
            }

            marketChart.update();
        })
        .catch(err => console.warn("Market API error:", err));
    }
    updateMarket();
    setInterval(updateMarket, 30000);

    // Bitcoin Price
    function updateBitcoin() {
        fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=inr")
        .then(res => res.json())
        .then(data => btcPriceEl.innerHTML = "â‚¹ " + data.bitcoin.inr);
    }
    updateBitcoin();
    setInterval(updateBitcoin, 30000);

    // Contact Form
    document.getElementById('contactForm').addEventListener('submit', function(e){
        e.preventDefault();
        alert('Thank you! Your message has been sent.');
        this.reset();
    });

    // Business Analytics Chart
    const ctxBusiness = document.getElementById('businessChart').getContext('2d');
    new Chart(ctxBusiness, {
        type: 'line',
        data: {
            labels: ['Jan','Feb','Mar','Apr','May','Jun'],
            datasets: [
                { label:'Revenue', data:[50000,60000,55000,70000,75000,80000], borderColor:'#10b981', fill:false, tension:0.3 },
                { label:'Expenses', data:[30000,35000,32000,40000,42000,45000], borderColor:'#f43f5e', fill:false, tension:0.3 }
            ]
        },
        options: {
            responsive:true,
            plugins:{legend:{labels:{color:'white'}}},
            scales:{
                x:{ticks:{color:'white'},grid:{color:'#1f2937'}},
                y:{ticks:{color:'white'},grid:{color:'#1f2937'}}
            }
        }
    });
</script>

</body>
</html>